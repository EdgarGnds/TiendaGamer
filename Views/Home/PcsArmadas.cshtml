@* PASO 1: Cambiamos el modelo. Ya no es IEnumerable<Product>,
    ahora es IEnumerable<Category> (la lista de subcategorías) *@
@model IEnumerable<Category>

@{
    ViewData["Title"] = "Pcs Armadas";
}

<div class="text-center my-5 titulo-contenedor">
    <h1 class="title-holo">PCs Armadas</h1>
    <p class="subtitle-holo">Explora nuestras configuraciones listas para dominar cualquier juego.</p>
</div>



<div class="row mt-n3">

    <nav class="col-md-3 col-lg-2 d-md-block sidebar-dark-custom sidebar collapse">
        <div class="position-sticky pt-3">
            <h4 class="subcat-title">Subcategorías</h4>
            <ul class="nav flex-column list-group">

                @* Creamos un enlace por cada subcategoría en el modelo *@
                @foreach (var subcategoria in Model)
                {
                    <li class="nav-item list-group-item-action">
                        @* Este enlace apunta a un ID de ancla (ej: #cat-1) *@
                        <a class="nav-link" href="#cat-@subcategoria.Id">
                            @subcategoria.Name
                        </a>
                    </li>
                }
            </ul>
        </div>
    </nav>

    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
        <h1 class="mt-3">@ViewData["Title"]</h1>
        <hr />

        @* Si no hay subcategorías, mostramos un mensaje *@
        @if (!Model.Any())
        {
            <p>No hay subcategorías de componentes disponibles.</p>
        }

        @* Hacemos un bucle por cada subcategoría *@
        @foreach (var subcategoria in Model)
        {
            <section class="mb-5" id="cat-@subcategoria.Id">

                @* Este es el ID de ancla al que apunta el sidebar *@
                <h2>@subcategoria.Name</h2>
                <hr />

                @* Revisamos si la subcategoría tiene productos *@
                @if (subcategoria.Products != null && subcategoria.Products.Any())
                {
                    <div class="row">
                        @* Hacemos un bucle por los productos de ESTA subcategoría *@
                        @foreach (var product in subcategoria.Products)
                        {
                            @* Reutilizamos nuestra tarjeta de producto *@
                            @await Html.PartialAsync("_ProductCard", product)
                        }
                    </div>
                }
                else
                {
                    <p>No hay productos en esta categoría por el momento.</p>
                }
            </section>
        }

    </main>
</div>

